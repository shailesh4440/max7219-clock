int BCD2DEC(int x) { return ((x)>>4)*10+((x)&0xf); }        // ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° ÐºÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ð¸ ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ†Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ðµ
int DEC2BCD(int x) { return (((x)/10)<<4)+((x)%10); }       // ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° ÐºÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ð¸ Ð¸Ð· Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ†Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ðµ
                                                            // Ð•Ð¡Ð›Ð˜ Ð²Ñ‹Ð±Ñ€Ð°Ð½ ÑÑ‚Ð°Ð½Ð´Ð°Ñ‚Ñ€Ð½Ñ‹Ð¹ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ RTC Ñ‚Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÑˆÐ¸Ð½Ñƒ I2C Ñ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¾Ð¹ Wire
#define I2CStart(x)   Wire.beginTransmission(x)             // ÐŸÑ€Ð¸ÑÐ²Ð°ÐµÐ²Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ I2CStart Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸ Ð¿Ð¾ ÑˆÐ¸Ð½Ðµ I2C(Ð°Ð´Ñ€ÐµÑ)
#define I2CStop()     Wire.endTransmission()                // ÐŸÑ€Ð¸ÑÐ²Ð°ÐµÐ²Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ I2CStop Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ ÐºÐ¾Ð½Ñ†Ð° Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸ Ð¿Ð¾ ÑˆÐ¸Ð½Ðµ I2C
#define I2CWrite(x)   Wire.write(x)                         // ÐŸÑ€Ð¸ÑÐ²Ð°ÐµÐ²Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ I2CWrite Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ(Ñ…)
#define I2CRead()     Wire.read()                           // ÐŸÑ€Ð¸ÑÐ²Ð°ÐµÐ²Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ I2CRead Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¹ ÑÑ‡ÐµÐ¹ÐºÐ¸
#define I2CReq(x,y)   Wire.requestFrom(x,y)
#define I2CReady      while(!Wire.available()) {};

#define DS3231_I2C_ADDRESS 0x68                             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
#define DS3231_I2C_ADDRESS_EEPROM 0x57                      // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ EEPROM RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…57
#define DS3231_TIME    0x00                                 // ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð±Ð»Ð¾ÐºÐ° Ñ‡Ð°ÑÐ¾Ð²
#define DS3231_DOW     0x03                                 // ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð±Ð»Ð¾ÐºÐ° Ð´ÐµÐ½ÑŒ Ð½ÐµÐ´ÐµÐ»Ð¸
#define DS3231_DATE    0x04                                 // ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð±Ð»Ð¾ÐºÐ° Ð´Ð°Ñ‚Ñ‹
#define DS3231_MEM     0x08                                 // ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð±Ð»Ð¾ÐºÐ° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…

//----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
void  setRTCDateTime() {                                    // Ð£Ð¡Ð¢ÐÐÐžÐ’ÐšÐ Ð’Ð Ð•ÐœÐ•ÐÐ˜ Ð˜ Ð”ÐÐ¢Ð« (Ñ‚ÑƒÑ‚ Ð¼Ñ‹ ÐµÐµ Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼)(ÑÐµÐºÑƒÐ½Ð´Ñ‹, Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹, Ñ‡Ð°ÑÑ‹, Ð´ÐµÐ½ÑŒ Ð½ÐµÐ´ÐµÐ»Ð¸, Ð´ÐµÐ½ÑŒ Ð¼ÐµÑÑÑ†Ð°, Ð¼ÐµÑÑÑ†, (Ð³Ð¾Ð´-2000))
  I2CStart(DS3231_I2C_ADDRESS);                             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
  I2CWrite(DS3231_TIME);                                    // ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° Ð°Ð´Ñ€ÐµÑ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð±Ð»Ð¾ÐºÐ° Ñ‡Ð°ÑÐ¾Ð² 0Ñ…00
  I2CWrite(DEC2BCD(second));                                // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ ÑÐµÐºÑƒÐ½Ð´Ñ‹ Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð· Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ‰Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ðµ
  I2CWrite(DEC2BCD(minute));                                // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð· Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ‰Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ðµ
  I2CWrite(DEC2BCD(hour));                                  // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ñ‡Ð°ÑÑ‹ Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð· Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ‰Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ðµ
  I2CWrite(DEC2BCD(dayOfWeek));                             // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð´ÐµÐ½ÑŒ Ð½ÐµÐ´ÐµÐ»Ð¸ Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ð½Ñ‹Ð¹ Ð¸Ð· Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ‰Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ðµ
  I2CWrite(DEC2BCD(day));                                   // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð´ÐµÐ½ÑŒ Ð¼ÐµÑÑÑ†Ð° Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ð½Ñ‹Ð¹ Ð¸Ð· Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ‰Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ðµ
  I2CWrite(DEC2BCD(month));                                 // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð¼ÐµÑÑÑ† Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ð½Ñ‹Ð¹ Ð¸Ð· Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ‰Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ðµ
  I2CWrite(DEC2BCD(year-2000));                             // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð³Ð¾Ð´ Ð±ÐµÐ· 2000 Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ð½Ñ‹Ð¹ Ð¸Ð· Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ñ… Ð² ÑˆÐµÑÑ‚Ð½Ð°Ð´Ñ‰Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ñ‹Ðµ
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
}
//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
void setRTCTime() {                                         // Ð£Ð¡Ð¢ÐÐÐžÐ’ÐšÐ Ð’Ð Ð•ÐœÐ•ÐÐ˜ (ÑÐµÐºÑƒÐ½Ð´Ñ‹, Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹, Ñ‡Ð°ÑÑ‹)
  I2CStart(DS3231_I2C_ADDRESS);                             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
  I2CWrite(DS3231_TIME);                                    // ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° Ð°Ð´Ñ€ÐµÑ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð±Ð»Ð¾ÐºÐ° Ñ‡Ð°ÑÐ¾Ð² 0Ñ…00
  I2CWrite(DEC2BCD(second));                                // Ð—Ð°Ð¿Ð¸ÑÑŒ Ð½Ð¾Ð²Ñ‹Ñ… ÑÐµÐºÑƒÐ½Ð´
  I2CWrite(DEC2BCD(minute));                                // Ð—Ð°Ð¿Ð¸ÑÑŒ Ð½Ð¾Ð²Ñ‹Ñ… Ð¼Ð¸Ð½ÑƒÑ‚
  I2CWrite(DEC2BCD(hour));                                  // Ð—Ð°Ð¿Ð¸ÑÑŒ Ð½Ð¾Ð°Ñ‹Ñ… Ñ‡Ð°ÑÐ¾Ð²
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
}
//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
void setRTCTimeNotSec() {                                   // Ð£Ð¡Ð¢ÐÐÐžÐ’ÐšÐ Ð’Ð Ð•ÐœÐ•ÐÐ˜ (Ð±ÐµÐ· ÑÐµÐºÑƒÐ½Ð´)
  I2CStart(DS3231_I2C_ADDRESS);                             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
  I2CWrite(DS3231_TIME+0x01);                               // ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° Ð°Ð´Ñ€ÐµÑ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð±Ð»Ð¾ÐºÐ° Ñ‡Ð°ÑÐ¾Ð² 0Ñ…00
  I2CWrite(DEC2BCD(minute));                                // Ð—Ð°Ð¿Ð¸ÑÑŒ Ð½Ð¾Ð²Ñ‹Ñ… Ð¼Ð¸Ð½ÑƒÑ‚
  I2CWrite(DEC2BCD(hour));                                  // Ð—Ð°Ð¿Ð¸ÑÑŒ Ð½Ð¾Ð°Ñ‹Ñ… Ñ‡Ð°ÑÐ¾Ð²
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
}
//---------------------------------------------------------------------------------------------------------------------------------------------
void setRTCDate() {                                         // Ð£Ð¡Ð¢ÐÐÐžÐ’ÐšÐ Ð”ÐÐ¢Ð« (Ð´ÐµÐ½ÑŒ, Ð¼ÐµÑÑÑ†, Ð³Ð¾Ð´)
  I2CStart(DS3231_I2C_ADDRESS);                             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
  I2CWrite(DS3231_DATE);                                    // Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð°Ð´Ñ€ÐµÑ Ð´Ð°Ñ‚Ñ‹ 0Ñ…04
  I2CWrite(DEC2BCD(day));                                   // Ð—Ð°Ð¿Ð¸ÑÑŒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð´Ð°Ñ‚Ñ‹ Ð² ÑÑ‡ÐµÐ¹ÐºÑƒ
  I2CWrite(DEC2BCD(month));                                 // Ð—Ð°Ð¿Ð¸ÑÑŒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¼ÐµÑÑÐ° Ð² ÑÑ‡ÐµÐ¹ÐºÑƒ
  I2CWrite(DEC2BCD(year-2000));                             // Ð—Ð°Ð¿Ð¸ÑÑŒ Ð² ÑÑ‡ÐµÐ¹ÐºÑƒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð³Ð¾Ð´Ð° - 2000
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
}
//----------------------------------------------------------------------------------------------------------------------------------------------
void setRTCDoW() {                                          // Ð£Ð¡Ð¢ÐÐÐžÐ’ÐšÐ Ð”ÐÐ¯ ÐÐ•Ð”Ð•Ð›Ð˜
  I2CStart(DS3231_I2C_ADDRESS);                             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
  I2CWrite(DS3231_DOW);                                     // Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð°Ð´Ñ€ÐµÑ ÑÑ‡ÐµÐ¹ÐºÐ¸ Ð³Ð´Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑÑ Ð½Ð°Ñˆ Ð´ÐµÐ½ÑŒ Ð½ÐµÐ´ÐµÐ»Ð¸
  I2CWrite(DEC2BCD(dayOfWeek));                             // Ð—Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð½Ð¾Ð²Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ Ð½ÐµÐ´ÐµÐ»Ð¸ Ð² ÑˆÐµÑÑ‚Ð½Ð°Ñ†Ð´Ð°Ñ‚Ð¸Ñ€Ð¸Ñ‡Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
}
//----------------------------------------------------------------------------------------------------------------------------------------------
void getRTCDateTime(void) {                                 // Ð¡Ð§Ð˜Ð¢Ð«Ð’ÐÐÐ˜Ð• Ð’Ð Ð•ÐœÐ•ÐÐ˜ Ð¸ Ð”ÐÐ¢Ð« Ð¸Ð· RTC Ð² (second, minute, hour, dayOfWeek, day,month, year)
  int v;                                                    // ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ
  I2CStart(DS3231_I2C_ADDRESS);                             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
  I2CWrite(DS3231_TIME);                                    // ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° Ð°Ð´Ñ€ÐµÑ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð±Ð»Ð¾ÐºÐ° Ñ‡Ð°ÑÐ¾Ð² 0Ñ…00
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
  I2CReq(DS3231_I2C_ADDRESS, 7);                            //
  I2CReady;                                                 //
  v = I2CRead() & 0x7f;                                     // ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ v - Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ÑÐµÐºÑƒÐ½Ð´ Ñ€Ð°Ð²Ð½Ð¾Ðµ 7 Ð±Ð¸Ñ‚Ð°Ð¼ (Ð¼Ð°Ñ…=63)
  second = BCD2DEC(v);                                      // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ ÑÐµÐºÑƒÐ½Ð´ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ v - Ð² Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
  v = I2CRead() & 0x7f;                                     // ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ v - Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¼Ð¸Ð½ÑƒÑ‚ Ñ€Ð°Ð²Ð½Ð¾Ðµ 7 Ð±Ð¸Ñ‚Ð°Ð¼ (Ð¼Ð°Ñ…=63)
  minute = BCD2DEC(v);                                      // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð¼Ð¸Ð½ÑƒÑ‚ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ v - Ð² Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
  v = I2CRead() & 0x3f;                                     // ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ v - Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ñ‡Ð°ÑÐ¾Ð² Ñ€Ð°Ð²Ð½Ð¾Ðµ 6 Ð±Ð¸Ñ‚Ð°Ð¼ (Ð¼Ð°Ñ…=31)
  hour = BCD2DEC(v);                                        // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ñ‡Ð°ÑÐ¾Ð² Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ v - Ð² Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
  v = I2CRead() & 0x07;                                     // ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ v - Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð½ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ Ñ€Ð°Ð²Ð½Ð¾Ðµ 3 Ð±Ð¸Ñ‚Ð°Ð¼ (Ð¼Ð°Ñ…=7)
  dayOfWeek = BCD2DEC(v);                                   // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð´Ð½ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ v - Ð² Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
  v = I2CRead() & 0x3f;                                     // ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ v - Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð½ÐµÐ¹ Ð¼ÐµÑÑÑ†Ð° Ñ€Ð°Ð²Ð½Ð¾Ðµ 6 Ð±Ð¸Ñ‚Ð°Ð¼ (Ð¼Ð°Ñ…=31)
  day = BCD2DEC(v);                                         // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð´Ð½ÐµÐ¹ Ð¼ÐµÑÑÑ†Ð° Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ v - Ð² Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
  v = I2CRead() & 0x3f;                                     // ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ v - Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¼ÐµÑÑÑ†Ð° Ñ€Ð°Ð²Ð½Ð¾Ðµ 6 Ð±Ð¸Ñ‚Ð°Ð¼ (Ð¼Ð°Ñ…=31)
  month = BCD2DEC(v);                                       // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð¼ÐµÑÑÑ†Ð° Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ v - Ð² Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
  v = I2CRead() & 0xff;                                     // ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ v - Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð³Ð¾Ð´Ð° Ñ€Ð°Ð²Ð½Ð¾Ðµ 8 Ð±Ð¸Ñ‚Ð°Ð¼ (Ð¼Ð°Ñ…=255)
  year = BCD2DEC(v) + 2000;                                 // Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð³Ð¾Ð´Ð° Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ v - Ð² Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ + 2000
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
}
//------------------------------------------------------------------------------------------------------------------------------------------------
void writeRTCMem(unsigned char addr, byte val) {            // Ð—ÐÐŸÐ˜Ð¡Ð¬ Ð’ ÐŸÐ¯ÐœÐ¯Ð¢Ð¬ RTC Ðº Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñƒ Ð±ÑƒÐ´Ð¸Ð»ÑŒÐ½Ð¸ÐºÐ¸
//Serial.print("write addr = ");Serial.println(addr);
  if(addr < 6){                                             // Ð’Ñ‹ÑˆÐµ 5 ÑÑ‡ÐµÐ¹ÐºÐ¸ Ð¿Ð¸ÑˆÐµÐ¼ Ð²Ð¾ Ñ„Ð»ÐµÑˆ Ð¿Ð°Ð¼ÑÑ‚ÑŒ
    I2CStart(DS3231_I2C_ADDRESS);                           // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
    I2CWrite(DS3231_MEM + addr);                            // ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ð±Ð»Ð¾ÐºÐ° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… + Ð½Ð°ÑˆÐ° ÑÑ‡ÐµÐ¹ÐºÐ°
    I2CWrite(val);                                          // Ð—Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð² Ð½Ð°ÑˆÑƒ ÑÑ‡ÐµÐ¹ÐºÑƒ
    I2CStop();                                              // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
  }
  else {
  Wire.beginTransmission(DS3231_I2C_ADDRESS_EEPROM);        // I2CStart(DS3231_I2C_ADDRESS_EEPROM);
  Wire.write((int)((addr - 6) >> 8));                       // I2CWrite(DS3231_MEM + addr);
  Wire.write((int)((addr - 6) & 0xFF));
  Wire.write(val);                                          // I2CWrite(val);
  Wire.endTransmission();                                   // I2CStop();
  }
}
//-------------------------------------------------------------------------------------------------------------------------------------------------
byte readRTCMem(byte addr) {                                // Ð§Ð¢Ð•ÐÐ˜Ð• Ð˜Ð— ÐŸÐÐœÐ¯Ð¢Ð˜ RTC (Ð¾Ð±Ð»Ð°ÑÑ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ)
//  Serial.print("read addr = ");Serial.print(addr);
//  if(addr>56) return 0;                                   // Ð½ÐµÐ»ÑŒÐ·Ñ ÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð²Ñ‹ÑˆÐµ 56 ÑÑ‡ÐµÐ¹ÐºÐ¸
  if (addr < 6){
  I2CStart(DS3231_I2C_ADDRESS);                             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
  I2CWrite(DS3231_MEM + addr);                              // ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ð±Ð»Ð¾ÐºÐ° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… + Ð½Ð°ÑˆÐ° ÑÑ‡ÐµÐ¹ÐºÐ°
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
  I2CReq(DS3231_I2C_ADDRESS, 1);
  I2CReady;
  unsigned char v = I2CRead();
  I2CStop();                                                // ÐšÐ¾Ð½ÐµÑ† I2C  Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°
  return v;
  }
  else{
  byte v = 0xFF;
  Wire.beginTransmission(DS3231_I2C_ADDRESS_EEPROM);        // I2CStart(DS3231_I2C_ADDRESS_EEPROM);
  Wire.write((int)((addr - 6) >> 8));                       // I2CWrite(DS3231_MEM + addr);
  Wire.write((int)((addr - 6) & 0xFF));
  Wire.endTransmission();                                   // I2CStop();
  Wire.requestFrom(DS3231_I2C_ADDRESS_EEPROM, 3);           // I2CReq(DS3231_I2C_ADDRESS_EEPROM, 1);
  if (Wire.available()) v = Wire.read();
  return v; 
  }
}
//--------------------------------------------------------------------------------------------------------------------------------------------------

float readTherm() {                                         // Ð§Ð¢Ð•ÐÐ˜Ð• Ð¢Ð•ÐœÐŸÐ•Ð ÐÐ¢Ð£Ð Ð« RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ(Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð° DS3231)
    byte temp;                                              // Ð² Ð²Ð¸Ð´Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ñ Ð¿Ð»Ð°Ð²Ð°ÑŽÑ‰ÐµÐ¹ Ð·Ð°Ð¿ÑÑ‚Ð¾Ð¹.
    Wire.beginTransmission(DS3231_I2C_ADDRESS);             // ÐÐ´Ñ€ÐµÑ Ð½Ð°ÑˆÐµÐ³Ð¾ RTC Ð¼Ð¾Ð´ÑƒÐ»Ñ 0Ñ…68
    Wire.write(0x11);                                       // ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¼Ð½Ð° Ð°Ð´Ñ€ÐµÑ Ð³Ð´Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑÑ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ð°
    Wire.endTransmission();

    Wire.requestFrom(DS3231_I2C_ADDRESS, 2);
    temp = Wire.read();                                     // Here's the MSB
    return float(temp) + 0.25*(Wire.read()>>6);
}
